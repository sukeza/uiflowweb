<html>
<head>
<script>
var lasttext;
function getuiflow(text){
	if (lasttext == text) {
		return;
	}
	var xhr = new XMLHttpRequest();
	xhr.responseType = "blob";
	// ハンドラの登録.
	xhr.onload = function(){
		var oURL = URL.createObjectURL(this.response);
		document.getElementById('img').src = oURL;
		console.log( 'COMPLETE! :');
	}
	xhr.open('POST', location.href + 'getimg.php', true);
	xhr.setRequestHeader('Content-Type','application/x-www-form-urlencoded');
	xhr.send('data='+encodeURI(text));
	lasttext = text;
	document.getElementById('txt').innerHTML = location.href + 'getimg.php?data=' + encodeURI(text);
}
</script>
<body>
<textarea rows=50 cols=100 onkeyup="javascript:getuiflow(this.value)">
</textarea><br>
<textarea id='txt' cols=100 disabled>
</textarea>
<div>
<img id='img'>
</div>
</body>
</html>

